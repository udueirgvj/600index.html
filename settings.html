<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªÙˆØ§ØµÙ„ - Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        body {
            background: #f0f2f5;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        .header {
            background: #2A6B9C;
            color: white;
            padding: 1rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .back-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.8rem;
            cursor: pointer;
        }
        .header h1 {
            font-size: 1.5rem;
            font-weight: 600;
            margin: 0;
        }
        .container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }
        /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© */
        .sidebar {
            width: 280px;
            background: white;
            border-left: 1px solid #eef2f7;
            overflow-y: auto;
            padding: 1rem 0;
        }
        .sidebar-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem 1.5rem;
            cursor: pointer;
            transition: background 0.2s;
            color: #1a2b3e;
            border-right: 3px solid transparent;
        }
        .sidebar-item:hover {
            background: #f0f2f5;
        }
        .sidebar-item.active {
            background: #e8f0fe;
            border-right-color: #2A6B9C;
            color: #2A6B9C;
            font-weight: 500;
        }
        .sidebar-item .icon {
            font-size: 1.3rem;
            width: 24px;
            text-align: center;
        }
        .sidebar-item .text {
            flex: 1;
        }
        /* Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
        .content {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
            background: #f9fcff;
        }
        .content-card {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            max-width: 600px;
            margin: 0 auto;
        }
        .content-card h2 {
            color: #1a2b3e;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
            border-bottom: 1px solid #eef2f7;
            padding-bottom: 0.8rem;
        }
        .input-group {
            margin-bottom: 1.2rem;
        }
        .input-group label {
            display: block;
            font-size: 0.9rem;
            font-weight: 500;
            color: #4b5f73;
            margin-bottom: 0.3rem;
        }
        .input-group input {
            width: 100%;
            padding: 0.8rem 1rem;
            border: 1px solid #d9e1ec;
            border-radius: 12px;
            background: #f9fcff;
            font-size: 1rem;
            outline: none;
        }
        .input-group input:focus {
            border-color: #2A6B9C;
            box-shadow: 0 0 0 3px rgba(42,107,156,0.1);
        }
        .btn {
            width: 100%;
            padding: 0.8rem;
            font-size: 1rem;
            font-weight: 600;
            border: none;
            border-radius: 30px;
            background: #2A6B9C;
            color: white;
            cursor: pointer;
            transition: background 0.2s;
            margin-top: 1rem;
        }
        .btn:hover {
            background: #1f4e7a;
        }
        .btn-secondary {
            background: #6c757d;
        }
        .btn-secondary:hover {
            background: #5a6268;
        }
        .btn-danger {
            background: #dc3545;
        }
        .btn-danger:hover {
            background: #bb2d3b;
        }
        .message {
            padding: 0.8rem;
            border-radius: 10px;
            margin-top: 1rem;
            text-align: center;
            display: none;
        }
        .message.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            display: block;
        }
        .message.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            display: block;
        }
        .info-text {
            color: #7f8fa4;
            font-size: 0.9rem;
            margin-top: 0.5rem;
        }
        .user-info {
            background: #f9fcff;
            padding: 1.5rem;
            border-radius: 16px;
            margin-bottom: 1.5rem;
        }
        .user-info p {
            margin-bottom: 0.5rem;
            color: #1a2b3e;
        }
        .user-info strong {
            color: #2A6B9C;
            min-width: 100px;
            display: inline-block;
        }
        .loading {
            text-align: center;
            padding: 2rem;
            color: #8899aa;
        }
        /* ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© */
        .section-placeholder {
            text-align: center;
            padding: 3rem;
            color: #8899aa;
        }
        .section-placeholder h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: #1a2b3e;
        }
        .faq-item {
            background: #f9fcff;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
            cursor: pointer;
            transition: background 0.2s;
        }
        .faq-item:hover {
            background: #eef2f7;
        }
        .faq-item h4 {
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: #1a2b3e;
        }
        .faq-item p {
            margin-top: 0.5rem;
            color: #4b5f73;
            display: none;
        }
        .faq-item.active p {
            display: block;
        }
    </style>
</head>
<body>
    <div class="header">
        <button class="back-btn" onclick="goBack()">â†</button>
        <h1>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h1>
        <div style="width: 40px;"></div>
    </div>

    <div class="container">
        <!-- Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-item active" data-section="account">
                <span class="icon">ğŸ‘¤</span>
                <span class="text">Ø§Ù„Ø­Ø³Ø§Ø¨</span>
            </div>
            <div class="sidebar-item" data-section="chats">
                <span class="icon">ğŸ’¬</span>
                <span class="text">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª</span>
            </div>
            <div class="sidebar-item" data-section="privacy">
                <span class="icon">ğŸ”’</span>
                <span class="text">Ø§Ù„Ø®ØµÙˆØµÙŠØ© ÙˆØ§Ù„Ø£Ù…Ø§Ù†</span>
            </div>
            <div class="sidebar-item" data-section="notifications">
                <span class="icon">ğŸ””</span>
                <span class="text">Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</span>
            </div>
            <div class="sidebar-item" data-section="storage">
                <span class="icon">ğŸ“</span>
                <span class="text">Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„ØªØ®Ø²ÙŠÙ†</span>
            </div>
            <div class="sidebar-item" data-section="folders">
                <span class="icon">ğŸ“‚</span>
                <span class="text">Ù…Ø¬Ù„Ø¯Ø§Øª Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª</span>
            </div>
            <div class="sidebar-item" data-section="devices">
                <span class="icon">ğŸ“±</span>
                <span class="text">Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©</span>
            </div>
            <div class="sidebar-item" data-section="power">
                <span class="icon">ğŸ”‹</span>
                <span class="text">ØªÙˆÙÙŠØ± Ø§Ù„Ø·Ø§Ù‚Ø©</span>
            </div>
            <div class="sidebar-item" data-section="language">
                <span class="icon">ğŸŒ</span>
                <span class="text">Ø§Ù„Ù„ØºØ©</span>
            </div>
            <div class="sidebar-item" data-section="faq">
                <span class="icon">â“</span>
                <span class="text">Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©</span>
            </div>
        </div>

        <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
        <div class="content" id="content">
            <!-- Ø³ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ Ø¹Ø¨Ø± JavaScript -->
            <div class="loading">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, updatePassword, EmailAuthProvider, reauthenticateWithCredential, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getDatabase, ref, update, get } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDRCtfuYrEdnuKUsWu_79NC6G_xGLznBJc",
            authDomain: "tttrt-b8c5a.firebaseapp.com",
            databaseURL: "https://tttrt-b8c5a-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "tttrt-b8c5a",
            storageBucket: "tttrt-b8c5a.firebasestorage.app",
            messagingSenderId: "975123752593",
            appId: "1:975123752593:web:e591e930af3a3e29568130"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const database = getDatabase(app);

        // Ø¹Ù†Ø§ØµØ± Ø§Ù„ØµÙØ­Ø©
        const sidebarItems = document.querySelectorAll('.sidebar-item');
        const contentDiv = document.getElementById('content');
        let currentUser = null;

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
        onAuthStateChanged(auth, async (user) => {
            if (!user) {
                window.location.href = 'index.html';
                return;
            }
            currentUser = user;
            await loadUserData();
            showSection('account'); // Ø¹Ø±Ø¶ Ù‚Ø³Ù… Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹
        });

        // ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙÙŠ Ù‚Ø³Ù… Ø§Ù„Ø­Ø³Ø§Ø¨)
        async function loadUserData() {
            try {
                const userRef = ref(database, 'users/' + currentUser.uid);
                const snapshot = await get(userRef);
                if (snapshot.exists()) {
                    window.userData = snapshot.val();
                } else {
                    window.userData = { email: currentUser.email };
                }
            } catch (error) {
                console.error(error);
                window.userData = { email: currentUser.email };
            }
        }

        // Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
        sidebarItems.forEach(item => {
            item.addEventListener('click', () => {
                sidebarItems.forEach(i => i.classList.remove('active'));
                item.classList.add('active');
                const section = item.dataset.section;
                showSection(section);
            });
        });

        function showSection(section) {
            let html = '';
            switch (section) {
                case 'account':
                    html = renderAccount();
                    break;
                case 'chats':
                    html = renderChats();
                    break;
                case 'privacy':
                    html = renderPrivacy();
                    break;
                case 'notifications':
                    html = renderNotifications();
                    break;
                case 'storage':
                    html = renderStorage();
                    break;
                case 'folders':
                    html = renderFolders();
                    break;
                case 'devices':
                    html = renderDevices();
                    break;
                case 'power':
                    html = renderPower();
                    break;
                case 'language':
                    html = renderLanguage();
                    break;
                case 'faq':
                    html = renderFaq();
                    break;
                default:
                    html = '<div class="loading">Ù‚Ø±ÙŠØ¨Ø§Ù‹...</div>';
            }
            contentDiv.innerHTML = html;
            attachEvents(section);
        }

        // Ø¯ÙˆØ§Ù„ Ø¹Ø±Ø¶ ÙƒÙ„ Ù‚Ø³Ù…
        function renderAccount() {
            const user = window.userData || {};
            return `
                <div class="content-card">
                    <h2>Ø§Ù„Ø­Ø³Ø§Ø¨</h2>
                    <div class="user-info">
                        <p><strong>Ø§Ù„Ø§Ø³Ù…:</strong> ${user.fullName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>
                        <p><strong>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</strong> ${user.username || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>
                        <p><strong>Ø§Ù„Ø¨Ø±ÙŠØ¯:</strong> ${user.email || currentUser?.email}</p>
                    </div>
                    <h3>ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø´Ø®ØµÙŠ</h3>
                    <div class="input-group">
                        <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯</label>
                        <input type="text" id="newFullName" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯" value="${user.fullName || ''}">
                    </div>
                    <button class="btn" onclick="updateFullName()">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø§Ø³Ù…</button>
                    <div id="nameMessage" class="message"></div>

                    <h3 style="margin-top: 2rem;">ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</h3>
                    <div class="input-group">
                        <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ©</label>
                        <input type="password" id="currentPassword" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ©">
                    </div>
                    <div class="input-group">
                        <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</label>
                        <input type="password" id="newPassword" placeholder="6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„">
                    </div>
                    <div class="input-group">
                        <label>ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                        <input type="password" id="confirmPassword" placeholder="Ø£Ø¹Ø¯ ÙƒØªØ§Ø¨Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
                    </div>
                    <button class="btn" onclick="changePassword()">ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</button>
                    <div id="passwordMessage" class="message"></div>

                    <button class="btn btn-danger" onclick="logout()" style="margin-top: 2rem;">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
                </div>
            `;
        }

        function renderChats() {
            return `
                <div class="content-card">
                    <h2>Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª</h2>
                    <p class="info-text">Ø®Ù„ÙÙŠØ© Ø§Ù„Ø´Ø§Ø´Ø©ØŒ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠØŒ Ø§Ù„Ù…Ø¤Ø«Ø±Ø§Øª Ø§Ù„Ø­Ø±ÙƒÙŠØ©</p>
                    <div style="margin-top: 1rem;">
                        <p>ğŸ”§ Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±...</p>
                    </div>
                </div>
            `;
        }

        function renderPrivacy() {
            return `
                <div class="content-card">
                    <h2>Ø§Ù„Ø®ØµÙˆØµÙŠØ© ÙˆØ§Ù„Ø£Ù…Ø§Ù†</h2>
                    <p class="info-text">Ø¢Ø®Ø± Ø¸Ù‡ÙˆØ±ØŒ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©ØŒ Ù…ÙØ§ØªÙŠØ­ Ø§Ù„Ù…Ø±ÙˆØ±</p>
                    <div style="margin-top: 1rem;">
                        <p>ğŸ”§ Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±...</p>
                    </div>
                </div>
            `;
        }

        function renderNotifications() {
            return `
                <div class="content-card">
                    <h2>Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</h2>
                    <p class="info-text">Ø§Ù„Ø£ØµÙˆØ§ØªØŒ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø§ØªØŒ Ø§Ù„Ø´Ø§Ø±Ø§Øª</p>
                    <div style="margin-top: 1rem;">
                        <p>ğŸ”§ Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±...</p>
                    </div>
                </div>
            `;
        }

        function renderStorage() {
            return `
                <div class="content-card">
                    <h2>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„ØªØ®Ø²ÙŠÙ†</h2>
                    <p class="info-text">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ØªÙ†Ø²ÙŠÙ„ Ø§Ù„ÙˆØ³Ø§Ø¦Ø·</p>
                    <div style="margin-top: 1rem;">
                        <p>ğŸ”§ Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±...</p>
                    </div>
                </div>
            `;
        }

        function renderFolders() {
            return `
                <div class="content-card">
                    <h2>Ù…Ø¬Ù„Ø¯Ø§Øª Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª</h2>
                    <p class="info-text">ÙØ±Ø² Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª ÙÙŠ Ù…Ø¬Ù„Ø¯Ø§Øª</p>
                    <div style="margin-top: 1rem;">
                        <p>ğŸ”§ Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±...</p>
                    </div>
                </div>
            `;
        }

        function renderDevices() {
            return `
                <div class="content-card">
                    <h2>Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©</h2>
                    <p class="info-text">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù…ØªØµÙ„Ø©</p>
                    <div style="margin-top: 1rem;">
                        <p>ğŸ”§ Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±...</p>
                    </div>
                </div>
            `;
        }

        function renderPower() {
            return `
                <div class="content-card">
                    <h2>ØªÙˆÙÙŠØ± Ø§Ù„Ø·Ø§Ù‚Ø©</h2>
                    <p class="info-text">ØªÙ‚Ù„ÙŠÙ„ Ø§Ø³ØªÙ‡Ù„Ø§Ùƒ Ø§Ù„Ø·Ø§Ù‚Ø© Ø¹Ù†Ø¯ Ø§Ù†Ø®ÙØ§Ø¶ Ø§Ù„Ø´Ø­Ù†</p>
                    <div style="margin-top: 1rem;">
                        <p>ğŸ”§ Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±...</p>
                    </div>
                </div>
            `;
        }

        function renderLanguage() {
            return `
                <div class="content-card">
                    <h2>Ø§Ù„Ù„ØºØ©</h2>
                    <p class="info-text">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© (Ù…Ø­Ø¯Ø¯Ø© Ø­Ø§Ù„ÙŠØ§Ù‹)</p>
                    <div style="margin-top: 1rem;">
                        <p>ğŸ”§ ÙŠÙ…ÙƒÙ† ØªØºÙŠÙŠØ± Ø§Ù„Ù„ØºØ© Ù„Ø§Ø­Ù‚Ø§Ù‹...</p>
                    </div>
                </div>
            `;
        }

        function renderFaq() {
            return `
                <div class="content-card">
                    <h2>Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©</h2>
                    <div class="faq-item">
                        <h4 onclick="toggleFaq(this)">ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ ØªØºÙŠÙŠØ± Ø§Ø³Ù…ÙŠØŸ <span>â–¼</span></h4>
                        <p>ÙŠÙ…ÙƒÙ†Ùƒ ØªØºÙŠÙŠØ± Ø§Ø³Ù…Ùƒ Ù…Ù† Ù‚Ø³Ù… "Ø§Ù„Ø­Ø³Ø§Ø¨" ÙÙŠ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§ØªØŒ Ø«Ù… Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯ ÙˆØ§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ ØªØ­Ø¯ÙŠØ«.</p>
                    </div>
                    <div class="faq-item">
                        <h4 onclick="toggleFaq(this)">ÙƒÙŠÙ Ø£ØºÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±ØŸ <span>â–¼</span></h4>
                        <p>Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ Ù‚Ø³Ù… "Ø§Ù„Ø­Ø³Ø§Ø¨"ØŒ Ø«Ù… Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ© ÙˆØ§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø«Ù… Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±.</p>
                    </div>
                    <div class="faq-item">
                        <h4 onclick="toggleFaq(this)">ÙƒÙŠÙ Ø£Ø¨Ø­Ø« Ø¹Ù† Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†ØŸ <span>â–¼</span></h4>
                        <p>ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©ØŒ Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø£Ø¹Ù„Ù‰ ÙˆØ§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯Ù‡.</p>
                    </div>
                    <div class="faq-item">
                        <h4 onclick="toggleFaq(this)">Ù‡Ù„ ØªØ·Ø¨ÙŠÙ‚Ù†Ø§ Ù…Ø¬Ø§Ù†ÙŠØŸ <span>â–¼</span></h4>
                        <p>Ù†Ø¹Ù…ØŒ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù…Ø¬Ø§Ù†ÙŠ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ ÙˆÙ„Ø§ ØªÙˆØ¬Ø¯ Ø£ÙŠ Ø±Ø³ÙˆÙ….</p>
                    </div>
                </div>
            `;
        }

        // Ø¯ÙˆØ§Ù„ Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ø±Ø¨Ø· Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
        window.toggleFaq = function(header) {
            const item = header.closest('.faq-item');
            item.classList.toggle('active');
            const span = header.querySelector('span');
            span.textContent = item.classList.contains('active') ? 'â–²' : 'â–¼';
        };

        // Ø¯ÙˆØ§Ù„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø§Ø³Ù… ÙˆØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± (Ø³ØªÙØ³ØªØ¯Ø¹Ù‰ Ù…Ù† HTML)
        window.updateFullName = async function() {
            const newName = document.getElementById('newFullName')?.value.trim();
            const msgDiv = document.getElementById('nameMessage');
            if (!newName) {
                showMessage(msgDiv, 'Ø§Ù„Ø§Ø³Ù… Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙƒÙˆÙ† ÙØ§Ø±ØºØ§Ù‹', false);
                return;
            }
            try {
                const userRef = ref(database, 'users/' + currentUser.uid);
                await update(userRef, { fullName: newName });
                showMessage(msgDiv, 'ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø§Ø³Ù… Ø¨Ù†Ø¬Ø§Ø­', true);
                window.userData.fullName = newName;
            } catch (error) {
                showMessage(msgDiv, 'Ø®Ø·Ø£: ' + error.message, false);
            }
        };

        window.changePassword = async function() {
            const current = document.getElementById('currentPassword')?.value;
            const newPass = document.getElementById('newPassword')?.value;
            const confirm = document.getElementById('confirmPassword')?.value;
            const msgDiv = document.getElementById('passwordMessage');
            if (!current || !newPass || !confirm) {
                showMessage(msgDiv, 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ù…Ø·Ù„ÙˆØ¨Ø©', false);
                return;
            }
            if (newPass.length < 6) {
                showMessage(msgDiv, 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„', false);
                return;
            }
            if (newPass !== confirm) {
                showMessage(msgDiv, 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚Ø©', false);
                return;
            }
            try {
                const credential = EmailAuthProvider.credential(currentUser.email, current);
                await reauthenticateWithCredential(currentUser, credential);
                await updatePassword(currentUser, newPass);
                showMessage(msgDiv, 'ØªÙ… ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¨Ù†Ø¬Ø§Ø­', true);
                document.getElementById('currentPassword').value = '';
                document.getElementById('newPassword').value = '';
                document.getElementById('confirmPassword').value = '';
            } catch (error) {
                if (error.code === 'auth/wrong-password') {
                    showMessage(msgDiv, 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ© ØºÙŠØ± ØµØ­ÙŠØ­Ø©', false);
                } else {
                    showMessage(msgDiv, 'Ø®Ø·Ø£: ' + error.message, false);
                }
            }
        };

        window.logout = async function() {
            await signOut(auth);
        };

        window.goBack = function() {
            window.location.href = 'app.html';
        };

        function showMessage(element, text, isSuccess) {
            element.textContent = text;
            element.className = isSuccess ? 'message success' : 'message error';
        }

        // Ø¥Ø¶Ø§ÙØ© Ø¯ÙˆØ§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ù†Ø§ÙØ°Ø© Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ Ù…Ù† HTML
        window.showMessage = showMessage;
    </script>
</body>
</html>
